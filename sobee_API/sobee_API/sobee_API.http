@baseUrl = https://localhost:7058

### ------------------------------------------------------------
### 0) Get products (pick a productId from response)
### ------------------------------------------------------------
GET {{baseUrl}}/api/products
Accept: application/json


### ------------------------------------------------------------
### 1) Add item to cart as GUEST
### - This should ISSUE X-Session-Id + X-Session-Secret in RESPONSE headers
### - Copy those values into @sessionId / @sessionSecret below
### ------------------------------------------------------------
POST {{baseUrl}}/api/cart/items
Content-Type: application/json
Accept: application/json

{
  "productId": 1003,
  "quantity": 2
}


### ------------------------------------------------------------
### 2) Set guest session vars (PASTE from response headers of step 1)
### ------------------------------------------------------------
@sessionId = 71a6f470-e602-4e68-be81-c0d52b5f8774
@sessionSecret = w76lgYIeSyt7H0Ti30tFdfU9en7NNaFG8+06GdtgWO0=


### ------------------------------------------------------------
### 3) Get cart as GUEST (should persist)
### ------------------------------------------------------------
GET {{baseUrl}}/api/cart
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}


### ------------------------------------------------------------
### 4) Apply promo as GUEST
### - Promo must exist in TPromotions and not be expired
### ------------------------------------------------------------
POST {{baseUrl}}/api/cart/promo/apply
Content-Type: application/json
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}

{
  "promoCode": "SUMMER10"
}


### ------------------------------------------------------------
### 5) Get cart again (should show promo + subtotal/discount/total)
### ------------------------------------------------------------
GET {{baseUrl}}/api/cart
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}


### ------------------------------------------------------------
### 6) Remove promo
### ------------------------------------------------------------
DELETE {{baseUrl}}/api/cart/promo
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}


### ------------------------------------------------------------
### 7) Get cart again (promo should be null, totals revert)
### ------------------------------------------------------------
GET {{baseUrl}}/api/cart
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}


### ------------------------------------------------------------
### 8) Update cart item quantity (set cartItemId from step 3 response)
### ------------------------------------------------------------
PUT {{baseUrl}}/api/cart/items/4
Content-Type: application/json
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}

{
  "quantity": 3
}


### ------------------------------------------------------------
### 9) Clear cart
### ------------------------------------------------------------
DELETE {{baseUrl}}/api/cart
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}


### ------------------------------------------------------------
### 10) Get cart (should be empty totals)
### ------------------------------------------------------------
GET {{baseUrl}}/api/cart
Accept: application/json
X-Session-Id: {{sessionId}}
X-Session-Secret: {{sessionSecret}}
