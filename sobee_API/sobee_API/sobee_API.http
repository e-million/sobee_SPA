@baseUrl = https://localhost:7058

# Set this to a real session id after Step 1.
@sessionId = 17bff474-31d8-4f94-a1fa-0978eb8984b6

# Paste your JWT after Step 9.
# Keep a placeholder value so the file parses even before login.
@token = CfDJ8FE_QEmxr_5Gl8E9uQQwwd2xqOPW2lfrKL51XrIpAI16UtZfTz2AOGZse9ki7GtBruVPxTbh1-yBxEgcful-sP0aSdSw5wetycxM9BpaTncq8q-B_mLg_jM8Ng8COUqPniu-o_F82K3kfC5hHahTmxocYToamNh44g8dQlxi1Ld4kudmzA8oILjx2OoR68ahMQJZ9KMprK_9xmZSwIa83n6w4N52OFjt2N6-_IMxf5c61GTVTsOg202jvLRHg58RzgBb0ajOnF947fJ5S3te392EF6akJpS0pyf1ReZDqGEPaxiNlNc-Oz1MkXgdYnpT2xAobG6M36nxkSq0HYckUiqCj7nYTvqCdJ-mUVlvkvsq5yG8mI8WryqX04Dr5nU_B35z6g_1hP_2A3Mf81L9thX3BXKwejQN9J2L8nV25BCayDh2HV-Eoi5No38ypCIGEEnyxINmX13zUpqF8ONe5WJSsAXyX6y6F5JmvSxYAaBH_mfIbI9mriUu1T7wPg0TyiTg6zoc9FvGqorT6nYFfOl52V_6AO8f-GhBQhH_xC-yI8MKlNio7t1Mi8g1meb7BeovLonGi6VFWpvn_sAXkhbdaHzwsYOWD98vgrACHWIEAZ3fnaQh_9pFzs7O8xpFhjcKlrWmmJP6so38l8dg7NSKr6W-C98tjnJ8imDm-seB0iJowXDFmYHcbBFHnezsDw

# Paste order id returned from checkout (Step 7) if your API returns it.
@orderId = 0

@email = million@local.com
@password = Admin123!

@productId1 = 1
@productId2 = 1


### =========================================================
### 0) HEALTH CHECK
### =========================================================
GET {{baseUrl}}/api/home/ping

### EXPECTED: 200 OK, JSON includes db=true


### =========================================================
### 1) GET CART (Guest) - creates cart if missing
### =========================================================
GET {{baseUrl}}/api/cart

### EXPECTED: 200 OK
### Copy returned sessionId into @sessionId above if it changed.


### =========================================================
### 2) ADD ITEM TO CART (Guest)
### =========================================================
POST {{baseUrl}}/api/cart/items
X-Session-Id: {{sessionId}}
Content-Type: application/json

{
  "productId": {{productId1}},
  "quantity": 2
}

### EXPECTED: 200 OK (or 201)
### Cart contains productId1 quantity 2


### =========================================================
### 3) ADD ANOTHER ITEM (Guest)
### =========================================================
POST {{baseUrl}}/api/cart/items
X-Session-Id: {{sessionId}}
Content-Type: application/json

{
  "productId": {{productId2}},
  "quantity": 1
}

# EXPECTED: 200 OK (or 201)


### =========================================================
### 4) VIEW CART (Guest)
### =========================================================
GET {{baseUrl}}/api/cart
X-Session-Id: {{sessionId}}

### EXPECTED: 200 OK
### items include productId1 qty 2, productId2 qty 1


### =========================================================
### 7) CHECKOUT (Guest -> creates Order)
### =========================================================
POST {{baseUrl}}/api/orders/checkout
X-Session-Id: {{sessionId}}
Content-Type: application/json

{
  "shippingAddress": "123 Test Street, Test City, OH 45200"
}

### EXPECTED: 200 OK (or 201)
### If response returns orderId, copy it into @orderId above.
### DB: order created with SessionId=sessionId, UserId NULL (before migration)


### =========================================================
### 8) GET SESSION ORDERS (Guest) - only if you implemented it
### =========================================================
GET {{baseUrl}}/api/orders/session
X-Session-Id: {{sessionId}}

### EXPECTED (if implemented): 200 OK with the guest order
### If not implemented: 404 Not Found (fine)


### =========================================================
### 9) LOGIN (Get JWT)
### =========================================================
POST {{baseUrl}}/login
Content-Type: application/json

{
  "email": "million@local.com",
  "password": "Admin123!"
}

### EXPECTED: 200 OK
### Copy accessToken into @token above (replace REPLACE_ME)


### =========================================================
### 10) GET CART (Authenticated + Session Header) **MIGRATION TRIGGER**
### =========================================================
GET {{baseUrl}}/api/cart
Authorization: Bearer {{token}}
X-Session-Id: {{sessionId}}

### EXPECTED: 200 OK
### DB: session cart should be attached to UserId after this call


### =========================================================
### 11) GET MY ORDERS (Authenticated) **VERIFY MIGRATION**
### =========================================================
GET {{baseUrl}}/api/orders/my
Authorization: Bearer {{token}}

### EXPECTED: 200 OK
### Should include the order created in Step 7 after migration


### =========================================================
### 12) GET ORDER BY ID (Authenticated) - only if you have this endpoint
### =========================================================
GET {{baseUrl}}/api/orders/6
Authorization: Bearer {{token}}

### EXPECTED: 200 OK (if orderId set to a real value)


### =========================================================
### 14) CLEAR ENTIRE CART (Guest) - clears items, usually does NOT delete cart row
### =========================================================
DELETE {{baseUrl}}/api/cart
X-Session-Id: {{sessionId}}

# EXPECTED: 200 OK (or 204)
# DB: cart items removed; cart row typically remains


### =========================================================
### 15) CLEAR ENTIRE CART (Authenticated)
### =========================================================
DELETE {{baseUrl}}/api/cart
Authorization: Bearer {{token}}

# EXPECTED: 200 OK (or 204)
